<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <title>–ü–æ–¥–¥–µ—Ä–∂–∫–∞ –ø—Ä–æ–µ–∫—Ç–∞</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <script src="https://telegram.org/js/telegram-web-app.js"></script>
  <style>
    body {
      font-family: sans-serif;
      text-align: center;
      padding: 2em;
      background-color: #f5f5f5;
    }
    input {
      font-size: 1.2em;
      width: 80%;
      padding: 10px;
      margin: 1em 0;
    }
    button {
      padding: 10px 20px;
      font-size: 1.1em;
      background-color: #3faeec;
      color: white;
      border: none;
      border-radius: 8px;
    }
    #balance {
      font-size: 1em;
      margin-bottom: 1em;
      color: #555;
    }
  </style>
</head>
<body>
  <h1>–°–∫–æ–ª—å–∫–æ –∑–≤—ë–∑–¥ –≤—ã —Ö–æ—Ç–∏—Ç–µ –æ—Ç–ø—Ä–∞–≤–∏—Ç—å?</h1>
  <div id="balance">–ó–∞–≥—Ä—É–∑–∫–∞ –±–∞–ª–∞–Ω—Å–∞...</div>
  <input type="number" id="starsInput" min="1" placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: 10">
  <br>
  <button onclick="sendStars()">üöÄ –û—Ç–ø—Ä–∞–≤–∏—Ç—å</button>

  <script>
    Telegram.WebApp.ready();

    const stars = Telegram.WebApp.initDataUnsafe?.stars;

    if (stars === undefined) {
      document.getElementById("balance").innerText =
        "‚ö†Ô∏è –ù–µ–≤–æ–∑–º–æ–∂–Ω–æ –ø–æ–ª—É—á–∏—Ç—å –∑–≤—ë–∑–¥—ã. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤—ã –∏—Å–ø–æ–ª—å–∑—É–µ—Ç–µ Telegram Business Bot –∏ –æ—Ç–∫—Ä—ã–ª–∏ WebApp –∏–∑ Telegram.";
    } else {
      document.getElementById("balance").innerText = `–í–∞—à –±–∞–ª–∞–Ω—Å: ${stars} –∑–≤—ë–∑–¥`;
    }

    function sendStars() {
      const amount = parseInt(document.getElementById("starsInput").value);

      if (isNaN(amount) || amount < 1) {
        alert("–í–≤–µ–¥–∏—Ç–µ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–≤—ë–∑–¥");
        return;
      }

      if (stars === undefined) {
        alert("–ù–µ–≤–æ–∑–º–æ–∂–Ω–æ –ø–æ–ª—É—á–∏—Ç—å –≤–∞—à –±–∞–ª–∞–Ω—Å. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –ø–æ–∑–∂–µ.");
        return;
      }

      if (amount > stars) {
        const goBuy = confirm("–£ –≤–∞—Å –Ω–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –∑–≤—ë–∑–¥. –•–æ—Ç–∏—Ç–µ –∫—É–ø–∏—Ç—å?");
        if (goBuy) {
          Telegram.WebApp.openTelegramStarsPurchase();
        }
        return;
      }

      const confirmSend = confirm(`–í—ã –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ —Ö–æ—Ç–∏—Ç–µ –æ—Ç–ø—Ä–∞–≤–∏—Ç—å ${amount} –∑–≤—ë–∑–¥?`);
      if (!confirmSend) return;

      Telegram.WebApp.sendData(JSON.stringify({ stars: amount }));
      Telegram.WebApp.close();
    }
  </script>
</body>
</html>
