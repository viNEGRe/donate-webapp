<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <title>Поддержка проекта</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <script src="https://telegram.org/js/telegram-web-app.js"></script>
  <style>
    body { font-family: sans-serif; text-align: center; padding: 2em; }
    input { font-size: 1.2em; width: 80%; margin: 1em 0; }
    button { padding: 10px 20px; font-size: 1.1em; }
  </style>
</head>
<body>
  <h1>Сколько звёзд вы хотите отправить?</h1>
  <input type="number" id="starsInput" min="1" placeholder="Например: 10">
  <br>
  <button onclick="sendStars()">🚀 Отправить</button>

  <script>
    Telegram.WebApp.ready();

    async function sendStars() {
      const stars = parseInt(document.getElementById("starsInput").value);

      if (isNaN(stars) || stars < 1) {
        alert("Введите корректное количество звёзд");
        return;
      }

      const balance = await Telegram.WebApp.getUserStarsBalance();

      if (balance === undefined) {
        alert("Ошибка: не удалось получить баланс звёзд.");
        return;
      }

      if (balance < stars) {
        Telegram.WebApp.openTelegramStarsPurchase();
        return;
      }

      const confirmed = confirm(`Вы уверены, что хотите отправить ${stars} звёзд?`);
      if (!confirmed) return;

      Telegram.WebApp.sendData(JSON.stringify({ stars }));
      Telegram.WebApp.close();
    }
  </script>
</body>
</html>
