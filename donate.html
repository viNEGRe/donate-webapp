<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <title>ÐŸÐ¾Ð´Ð´ÐµÑ€Ð¶ÐºÐ° Ð¿Ñ€Ð¾ÐµÐºÑ‚Ð°</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <script src="https://telegram.org/js/telegram-web-app.js"></script>
  <style>
    body { font-family: sans-serif; text-align: center; padding: 2em; }
    input { font-size: 1.2em; width: 80%; margin: 1em 0; }
    button { padding: 10px 20px; font-size: 1.1em; }
  </style>
</head>
<body>
  <h1>Ð¡ÐºÐ¾Ð»ÑŒÐºÐ¾ Ð·Ð²Ñ‘Ð·Ð´ Ð²Ñ‹ Ñ…Ð¾Ñ‚Ð¸Ñ‚Ðµ Ð¾Ñ‚Ð¿Ñ€Ð°Ð²Ð¸Ñ‚ÑŒ?</h1>
  <input type="number" id="starsInput" min="1" placeholder="ÐÐ°Ð¿Ñ€Ð¸Ð¼ÐµÑ€: 10">
  <br>
  <button onclick="sendStars()">ðŸš€ ÐžÑ‚Ð¿Ñ€Ð°Ð²Ð¸Ñ‚ÑŒ</button>

  <script>
    Telegram.WebApp.ready();

    async function sendStars() {
      const stars = parseInt(document.getElementById("starsInput").value);

      if (isNaN(stars) || stars < 1) {
        alert("Ð’Ð²ÐµÐ´Ð¸Ñ‚Ðµ ÐºÐ¾Ñ€Ñ€ÐµÐºÑ‚Ð½Ð¾Ðµ ÐºÐ¾Ð»Ð¸Ñ‡ÐµÑÑ‚Ð²Ð¾ Ð·Ð²Ñ‘Ð·Ð´");
        return;
      }

      const balance = await Telegram.WebApp.getUserStarsBalance();

      if (balance === undefined) {
        alert("ÐžÑˆÐ¸Ð±ÐºÐ°: Ð½Ðµ ÑƒÐ´Ð°Ð»Ð¾ÑÑŒ Ð¿Ð¾Ð»ÑƒÑ‡Ð¸Ñ‚ÑŒ Ð±Ð°Ð»Ð°Ð½Ñ Ð·Ð²Ñ‘Ð·Ð´.");
        return;
      }

      if (balance < stars) {
        Telegram.WebApp.openTelegramStarsPurchase();
        return;
      }

      const confirmed = confirm(`Ð’Ñ‹ ÑƒÐ²ÐµÑ€ÐµÐ½Ñ‹, Ñ‡Ñ‚Ð¾ Ñ…Ð¾Ñ‚Ð¸Ñ‚Ðµ Ð¾Ñ‚Ð¿Ñ€Ð°Ð²Ð¸Ñ‚ÑŒ ${stars} Ð·Ð²Ñ‘Ð·Ð´?`);
      if (!confirmed) return;

      Telegram.WebApp.sendData(JSON.stringify({ stars }));
      Telegram.WebApp.close();
    }
  </script>
</body>
</html>
